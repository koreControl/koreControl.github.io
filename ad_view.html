<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Processor</title>
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    <style> 
        body { margin: 0; background: #000; overflow: hidden; } 
        /* The Player */
        #video-container { width: 100vw; height: 100vh; display: block; }
        /* A tiny status indicator in the corner so you know it's alive */
        #status { 
            position: absolute; top: 10px; left: 10px; z-index: 99; 
            color: #00ff00; font-family: monospace; font-size: 12px;
            background: rgba(0,0,0,0.5); padding: 5px; pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="status">Initializing...</div>

    <div id="video-container">
        <video id="my-video">
            <source src="https://cdn.fluidplayer.com/videos/valerian-1080p.m4v" type="video/mp4"/>
        </video>
    </div>

    <script>
        // --- SETTINGS ---
        const videoTag = 'https://homelybottle.com/d.mrf/zRddGmNov/Z/G/UY/Ve/me9DuDZJUP1/k/PST/Yd3yMajdQK2JNSTFQLtxN-jEcmyzNYD/Yw1GN-Qo';
        const refreshOnSuccess = 600000; // 10 Minutes (If ad plays)
        const refreshOnFail = 3000;      // 3 Seconds (If ad fails)
        // ----------------

        let adPlayed = false;

        var myPlayer = fluidPlayer('my-video', {
            layoutControls: {
                primaryColor: false, posterImage: false, playButtonShowing: false, 
                playPauseAnimation: false, fillToContainer: true, 
                autoPlay: true, mute: true
            },
            vastOptions: {
                allowVPAID: true, 
                adList: [{ roll: 'preRoll', vastTag: videoTag }],
                vastAdvanced: {
                    // 1. IF AD FAILS (No Fill / Error)
                    noVastVideoCallback: function() { 
                        setStatus("No Ad Available. Retrying...");
                        retry();
                    },
                    // 2. IF AD STARTS
                    vastVideoStartedCallback: function() {
                        setStatus("Ad Playing (Revenue Generating)");
                        adPlayed = true;
                    },
                    // 3. IF AD ENDS
                    vastVideoEndedCallback: function() {
                        setStatus("Ad Finished. Waiting 10 mins...");
                        // Hide player to show black screen
                        document.getElementById('video-container').style.display = 'none';
                        setTimeout(() => window.location.reload(), refreshOnSuccess);
                    }
                }
            }
        });

        // SAFETY TIMER: If nothing happens for 8 seconds, assume broken and reload
        setTimeout(function() {
            if (!adPlayed) {
                setStatus("Timeout/Stuck. Force Reloading...");
                retry();
            }
        }, 8000); 

        function retry() {
            setTimeout(() => window.location.reload(), refreshOnFail);
        }

        function setStatus(msg) {
            document.getElementById('status').innerText = msg;
            console.log(msg);
        }

        // Generic Player Error
        myPlayer.on('error', function() { retry(); });

    </script>
</body>
</html>
