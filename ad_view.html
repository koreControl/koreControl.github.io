<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Player</title>
    <script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>
    <style> 
        body { margin: 0; background: black; overflow: hidden; } 
        #video-container { width: 100vw; height: 100vh; display: block; }
    </style>
</head>
<body>

    <div id="video-container">
        <video id="my-video">
            <source src="https://cdn.fluidplayer.com/videos/valerian-1080p.m4v" type="video/mp4"/>
        </video>
    </div>

    <script>
        // --- CONFIGURATION ---
        const videoTag = 'https://homelybottle.com/dHmIFHz/d.GRNKvHZtGXUn/hemmM9GuyZdUPlYkuP/T/YF3HMcjQQb2mNRTZQ/t/Ncj/c_ycN/DeYc1qNiQe';
        const cycleTime = 600000; // 10 Minutes Success Timer
        const failTime = 5000;    // 5 Seconds Retry Timer
        // ---------------------

        let adSuccess = false;

        var myPlayer = fluidPlayer('my-video', {
            layoutControls: {
                primaryColor: false, posterImage: false, playButtonShowing: false, 
                playPauseAnimation: false, fillToContainer: true, 
                autoPlay: true, mute: true
            },
            vastOptions: {
                adList: [{ roll: 'preRoll', vastTag: videoTag }],
                vastAdvanced: {
                    // IF VIDEO FAILS:
                    noVastVideoCallback: function() { 
                        console.log("No Ad. Retrying...");
                        quickRetry(); 
                    },
                    // IF VIDEO STARTS:
                    vastVideoStartedCallback: function() {
                        console.log("Ad Started!");
                        adSuccess = true;
                    },
                    // IF VIDEO ENDS:
                    vastVideoEndedCallback: function() {
                        console.log("Ad Finished. Waiting for cycle.");
                        hideAndSchedule();
                    }
                }
            }
        });

        // WATCHDOG: If nothing happens in 8 seconds, force reload
        setTimeout(function() {
            if (!adSuccess) {
                console.log("Watchdog: Ad stuck. Retrying.");
                quickRetry();
            }
        }, 8000); 

        // 1. Quick Retry (If ad fails, try again in 5 seconds)
        function quickRetry() {
            setTimeout(function(){
               window.location.reload();
            }, failTime);
        }

        // 2. Long Wait (If ad succeeds, wait 10 mins)
        function hideAndSchedule() {
            document.getElementById('video-container').style.display = 'none';
            setTimeout(function(){
               window.location.reload();
            }, cycleTime);
        }

        // Handle generic errors
        myPlayer.on('error', function() { quickRetry(); });

    </script>
</body>
</html>
